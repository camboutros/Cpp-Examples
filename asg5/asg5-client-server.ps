%!PS-Adobe-3.0
%%Creator: groff version 1.22.2
%%CreationDate: Mon May  9 16:12:31 2016
%%Title: asg5-client-server.ps
%%BoundingBox: 0 0 612 792
%%DocumentNeededResources: font Courier
%%+ font Courier-Bold
%%+ font NewCenturySchlbk-Bold
%%+ font NewCenturySchlbk-Roman
%%+ font NewCenturySchlbk-Italic
%%+ font Symbol
%%DocumentSuppliedResources: procset grops 1.22 2
%%+ font Courier-Elite-Bold
%%+ font Courier-Elite
%%Pages: 5
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.22 2
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/Fr{
setrgbcolor fill
}bind def
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
/Fg{
setgray fill
}bind def
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Courier
%%IncludeResource: font Courier-Bold
%%IncludeResource: font NewCenturySchlbk-Bold
%%IncludeResource: font NewCenturySchlbk-Roman
%%IncludeResource: font NewCenturySchlbk-Italic
%%IncludeResource: font Symbol
%%BeginResource: font Courier-Elite-Bold
%%DocumentNeededResources: font Courier-Bold
/MakeTransformedFont{
findfont dup maxlength dict begin
{
exch dup dup/FID ne exch/UniqueID ne and{
exch def
}{
pop pop
}ifelse
}forall
/FontBBox
currentdict/FontBBox get
4 array copy def
FontBBox aload pop
4 index transform 4 2 roll
4 index transform 4 2 roll
FontBBox astore pop
FontMatrix exch matrix concatmatrix
/FontMatrix exch def
dup/FontName exch def
currentdict end
definefont pop
}bind def
/Courier-Elite-Bold
[ .833333333 0 0 1 0 0 ]
/Courier-Bold
MakeTransformedFont
%%EndResource
%%BeginResource: font Courier-Elite
%%DocumentNeededResources: font Courier
/MakeTransformedFont{
findfont dup maxlength dict begin
{
exch dup dup/FID ne exch/UniqueID ne and{
exch def
}{
pop pop
}ifelse
}forall
/FontBBox
currentdict/FontBBox get
4 array copy def
FontBBox aload pop
4 index transform 4 2 roll
4 index transform 4 2 roll
FontBBox astore pop
FontMatrix exch matrix concatmatrix
/FontMatrix exch def
dup/FontName exch def
currentdict end
definefont pop
}bind def
/Courier-Elite
[ .833333333 0 0 1 0 0 ]
/Courier
MakeTransformedFont
%%EndResource
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/NewCenturySchlbk-Italic@0 ENC0/NewCenturySchlbk-Italic RE
/Courier-Elite-Bold@0 ENC0/Courier-Elite-Bold RE/Courier-Elite@0 ENC0
/Courier-Elite RE/NewCenturySchlbk-Roman@0 ENC0/NewCenturySchlbk-Roman
RE/NewCenturySchlbk-Bold@0 ENC0/NewCenturySchlbk-Bold RE
%%EndProlog
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CMPS-109 \203 W)72 50 Q
(inter 2016 \203 Program 5 \203 Client/Server and Sockets)-.216 E/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(1o)32.16 G 3.336(f5)-3.336 G/F2 11
/Courier-Elite@0 SF
($Id: asg5-client-server.mm,v 1.60 2016-05-09 16:12:29-07 - - $)72 67 Q
(PWD: /afs/cats.ucsc.edu/courses/cmps109-wm/Assignments/asg5-client-ser\
ver)72 80 Q(URL: http://www2.ucsc.edu/courses/cmps109-wm/:/Assignments/\
asg5-client-server/)72 93 Q F0 3.444(1. Overview)72 117 R F1 2.531
(This project will implement a c)72 137 R 2.531
(lient/server application using soc)-.084 F(kets)-.084 E 9.202(.A)-.3 G
(daemon)-3.336 E(\()72 151 Q/F3 12/Courier-Elite-Bold@0 SF(cixd)A F1
3.955(\)l)C .619(istens on a soc)-3.955 F .619(ket for c)-.084 F .619
(lient connection requests)-.084 F 7.291(.E)-.3 G(ac)-7.291 E 3.955(hc)
-.084 G .619(onnection will cause)-3.955 F .204(the server to fork a c)
72 165 R .203(hild process to serve the c)-.084 F 3.539(lient. The)-.084
F .203(daemon runs in an in\214nite)3.539 F .489(loop listening)72 179 R
7.161(.T)-.3 G .489(he server exits when the c)-7.161 F .489
(lient disconnects)-.084 F 7.161(.A)-.3 G -.084(cl)-3.336 G .489
(ient \().084 F F3(cix)A F1 3.825(\)c)C(onnects)-3.825 E 1.673
(to a server and can send \214les)72 193 R 5.009(,r)-.3 G 1.673
(eceive \214les)-5.009 F 5.008(,a)-.3 G 1.672
(nd get a summary listing of all \214les)-5.008 F(present.)72 207 Q
4.589(As)72 227 S(oc)-4.589 E 1.253(ket is a two-w)-.084 F 1.493 -.12
(ay m)-.216 H 1.254(eans of communication between processes).12 F 4.59
(,n)-.3 G 1.254(ot necessarily)-4.59 F 2.195(running on the same host.)
72 241 R 2.194(An IPv4 host is know by a 4-octet sequence suc)8.867 F
5.53(ha)-.084 G(s)-5.53 E .876(128.114.108.152, and a port is an unsign\
ed 16-bit number \(0 to 65535\).)72 255 R(Communi-)7.548 E
(cation will be done via TCP/IP over IPv4 soc)72 269 Q(kets)-.084 E(.)
-.3 E F0 3.444(2. Programs)72 295 R F1 2.65(In this project, two main p\
rograms are to be written for the three parts of the)72 315 R -1.336
(project :)72 329 R 1.29(the daemon and server)7.962 F 4.627(,a)-1.2 G
1.291(nd the c)-4.627 F 4.627(lient. There)-.084 F 1.291
(will also be several library)4.627 F
(\214les written to be used by the programs)72 343 Q 6.672(.T)-.3 G
(he general function is similar to)-6.672 E F3(sftp)3.336 E F1(\(1\).)A
F3(cixd)72 363 Q F1 -1.336(Usage :)102 377 R F3(cixd)6.672 E F1([)5.336
E/F4 12/NewCenturySchlbk-Italic@0 SF(port)A F1(])A .104
(Creates a server soc)102 397 R .104
(ket and goes into an in\214nite loop)-.084 F 6.776(:W)2 G .104
(hen it accepts a c)-6.776 F(lient)-.084 E(soc)102 411 Q 1.067
(ket, it uses)-.084 F F3(fork)4.403 E F1 1.067(\(2\) to create a c)B
1.067(hild process)-.084 F 4.403(,w)-.3 G(hic)-4.403 E 4.403(hf)-.084 G
1.067(unctions as the server)-4.403 F(to communicate with the c)102 425
Q(lient.)-.084 E 1.161
(The daemon listens for connections on the given port, if speci\214ed.)
102 445 R 1.161(If not, the)7.833 F .64(environment variable)102 459 R
F3(CIX_SERVER_PORT)3.976 E F1 .641(is used to determine the port.)3.977
F .641(There is)7.313 F(no default port.)102 473 Q 1.363
(The server is forked with an open soc)102 493 R 1.363
(ket communicating with the c)-.084 F 4.699(lient. Its)-.084 F 1.156
(loop repeatedly reads commands and information from the c)102 507 R
1.157(lient and acts on)-.084 F 1.46(those commands)102 521 R 4.796(,r)
-.3 G 1.46(eturning information bac)-4.796 F 4.796(kt)-.084 G 4.796(ot)
-4.796 G 1.46(he c)-4.796 F 4.796(lient. Its)-.084 F 1.46
(loop will be a)4.796 F 1.992
(receive followed by a send, responding to c)102 535 R 1.992
(lient requests)-.084 F 8.664(.I)-.3 G 5.328(te)-8.664 G 1.992
(xits when the)-5.328 F -.084(cl)102 549 S .833(ient c).084 F .833
(loses the soc)-.084 F 4.169(ket. It)-.084 F .833
(does no terminal I/O except possibly for debugging)4.169 F(purposes)102
563 Q(.)-.3 E F3(cix)72 583 Q F1 -1.336(Usage :)102 597 R F3(cix)6.672 E
F1([)5.336 E F4(host)A F1 5.336(][)C F4(port)-5.336 E F1(])A .901(The c)
102 617 R .901(lient interacts with the user)-.084 F 7.573(.C)-1.2 G
.901(ommands are read from the terminal \(or)-7.573 F 1.054
(redirect\), eac)102 631 R 4.39(ho)-.084 G 4.39(fw)-4.39 G(hic)-4.39 E
4.389(hi)-.084 G 4.389(se)-4.389 G 1.053
(xecuted one at a time by communicating with the)-4.389 F(server)102 645
Q 6.672(.R)-1.2 G(esults are then displa)-6.672 E(yed at the terminal.)
-.12 E .382(The c)102 665 R .382
(lient connects to the given host, if speci\214ed.)-.084 F .382
(If not speci\214ed, the environ-)7.054 F 1.04(ment variable)102 679 R
F3(CIX_SERVER_HOST)4.376 E F1 1.039(is used as the host to connect to)
4.376 F 7.711(.I)-.216 G 4.375(fn)-7.711 G 1.039(ot speci-)-4.375 F
(\214ed,)102 693 Q F3(localhost)3.586 E F1 .25(is used.)3.586 F .25
(It tries to connect to the given port, if speci\214ed.)6.922 F .251
(If not,)6.923 F 4.12(the environment variable)102 707 R F3
(CIX_SERVER_PORT)7.456 E F1 4.12(is used to determine the port.)7.456 F
(There is no default port.)102 721 Q 0 Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CMPS-109 \203 W)72 50 Q
(inter 2016 \203 Program 5 \203 Client/Server and Sockets)-.216 E/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(2o)32.16 G 3.336(f5)-3.336 G F0 3.444
(3. Interactive)72 74 R(Commands)3.444 E F1(The)72 94 Q/F2 12
/Courier-Elite-Bold@0 SF(cix)3.477 E F1 -.084(cl)3.477 G .141(ient resp\
onds to commands read from the standard output and writes out-).084 F
3.417(put to the standard output and error and accesses \214les)72 108 R
10.089(.I)-.3 G 6.753(nt)-10.089 G 3.417(he syntax below)-6.753 F(,)-1.5
E F2 .653(Courier Bold)72 122 R F1 .653(are literal c)3.989 F .653
(haracters actually typed in, while)-.084 F/F3 12
/NewCenturySchlbk-Italic@0 SF .653(Roman Italic)3.989 F F1 .653
(stands for)3.989 F(appropriate substitutions)72 136 Q(.)-.3 E F2(exit)
72 156 Q F1(Quit the program.)102 170 Q
(An end of \214le marker or Control/D is equivalent.)6.672 E F2(get)72
190 Q F3(\214lename)6 E F1 1.283(Copy the \214le named)102 204 R F3
(\214lename)4.618 E F1 1.282
(on the remote server and create or overwrite a)4.618 F
(\214le of the same name in the current directory)102 218 Q(.)-1.5 E F2
(help)72 238 Q F1 3.336(As)102 252 S(ummary of a)-3.336 E
(vailable commands is printed.)-.12 E F2(ls)72 272 Q F1 .272
(Causes the remote server to execute the command)102 286 R F2 .272
(ls -l)3.608 F F1 .273(and prints the output)3.609 F(to the user')102
300 Q 3.336(st)-.3 G(erminal.)-3.336 E F2(put)72 320 Q F3(\214lename)6 E
F1 1.003(Copies a local \214le into the soc)102 334 R 1.003
(ket and causes the remote server to create that)-.084 F
(\214le in its directory)102 348 Q(.)-1.5 E F2(rm)72 368 Q F3
(\214lename)6 E F1(Causes the remote server to remove the \214le)102 382
Q(.)-.216 E F0 3.444(4. Protocol)72 408 R(used by the)3.444 E F2(cix*)
3.444 E F0(programs)3.444 E F1 .019(In order for the c)72 428 R .02
(lient and server to communicate)-.084 F 3.356(,ap)-.216 G .02
(rotocol needs to be established.)-3.356 F .87(This means that eac)72
442 R 4.206(hm)-.084 G .869
(essage needs to be framed in terms of a header and a pa)-4.206 F(y-)
-.12 E 3.501(load. The)72 456 R .165(header alw)3.501 F -.12(ay)-.216 G
3.501(sc).12 G .165(onsists of a)-3.501 F F2(struct)3.501 E F1 .166
(of size 64 bytes)3.501 F 6.838(.A)-.3 G .166(ll messages between)-6.838
F -.084(cl)72 470 S .046(ient and server consist of these 64 bytes).084
F 3.381(,p)-.3 G .045(ossibly followed by a pa)-3.381 F 3.381(yload. F)
-.12 F .045(or align-)-.66 F .913(ment purposes)72 484 R 4.249(,t)-.3 G
(he)-4.249 E F2(nbytes)4.249 E F1 .914(\214eld is \214rst.)4.249 F .914
(Before \214lling in the \214elds)7.586 F 4.25(,u)-.3 G(se)-4.25 E F2
(memset)4.25 E F1 .914(\(3\) to)B -.084(cl)72 498 S(ear the struct.).084
E F2(enum class cix_command : uint8_t {)102 518 Q
(ERROR = 0, EXIT, GET, HELP, LS, PUT, RM, FILE, LSOUT, ACK, NAK)120 532
Q(};)102 546 Q(size_t constexpr FILENAME_SIZE = 59;)102 560 Q
(struct cix_header {)102 574 Q(uint32_t nbytes {0};)120 588 Q
(cix_command command {cix_command::ERROR};)120 602 Q
(char filename[FILENAME_SIZE] {};)120 616 Q(};)102 630 Q F1
(The purposes of the \214elds are as follows)72 650 Q(:)2 E F2
(uint32_t nbytes;)72 670 Q F1 .298(The number of bytes in the pa)102 684
R .297(yload if there is any pa)-.12 F 3.633(yload. Otherwise)-.12 F
.297(it must)3.633 F 1.39(be zero \(MBZ\).)102 698 R 1.39
(This \214eld is sent in network byte order and so must use the)8.062 F
(functions)102 712 Q F2(ntohl)3.336 E F1(\(3\) and)A F2(htonl)3.336 E F1
(\(3\) when loading and storing data.)A 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CMPS-109 \203 W)72 50 Q
(inter 2016 \203 Program 5 \203 Client/Server and Sockets)-.216 E/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(3o)32.16 G 3.336(f5)-3.336 G/F2 12
/Courier-Elite-Bold@0 SF(uint8_t command;)72 74 Q F1 3.336(As)102 88 S
(ingle byte containing one of the)-3.336 E F2(cix_command)3.336 E F1
(constants)3.336 E(.)-.3 E F2(char filename[59];)72 108 Q F1 .135
(The name of the \214le being transferred or removed.)102 122 R .135
(The \214lename ma)6.807 F 3.47(yn)-.12 G .134(ot ha)-3.47 F(ve)-.12 E
1.244(any slash \()102 136 R F2('/')A F1 4.58(\)c)C 1.244
(haracters in it and must be null-terminated \(with)-4.664 F F2('\\0')
4.58 E F1 4.58(\). All)B 1.344
(bytes following the null must also be null.)102 150 R -.444(Pa)8.016 G
1.344(thnames with slashes and \214le-).444 F(names longer than 58 c)102
164 Q(haracters are prohibited.)-.084 E -.66(Fo)72 184 S .653
(llowing are the meanings of eac).66 F 3.989(ho)-.084 G 3.99(ft)-3.989 G
(he)-3.99 E F2(cix_command)3.99 E F1(values)3.99 E 7.326(.E)-.3 G(ac)
-7.326 E 3.99(hi)-.084 G 3.99(se)-3.99 G .654(ither c)-3.99 F(lient)
-.084 E(to server \(C)72 198 Q/F3 12/Symbol SF<ae>A F1
(S\) or server to c)A(lient \(S)-.084 E F3<ae>A F1(C\), but never both.)
A F2(cix_command::ERROR)72 218 Q F1
(An error \215ag to indicate an invalid header)102 232 Q 6.672(.U)-1.2 G
(sed internally)-6.672 E(.)-1.5 E F2(cix_command::EXIT)72 252 Q F1
(Internal to)102 266 Q F2(cix)3.336 E F1 3.336(,n)C
(ot used in communication.)-3.336 E F2(cix_command::GET)72 286 Q F1(\(C)
6 E F3<ae>A F1(S\))A .426(Request a \214le from the server)102 300 R
7.098(.T)-1.2 G .425(he \214lename is used both remotely and locally)
-7.098 F(.)-1.5 E(The pa)102 314 Q(yload length is 0.)-.12 E F2
(cix_command::HELP)72 334 Q F1(Internal to)102 348 Q F2(cix)3.336 E F1
3.336(,n)C(ot used in communication.)-3.336 E F2(cix_command::LS)72 368
Q F1(\(C)6 E F3<ae>A F1(S\))A(Request \214le \()102 382 Q F2(ls)A F1
3.336(\)i)C 3.336(nformation. The)-3.336 F(pa)3.336 E
(yload length and \214lename are zeroed.)-.12 E F2(cix_command::PUT)72
402 Q F1(\(C)6 E F3<ae>A F1(S\))A 1.263(The length of the pa)102 416 R
1.263(yload is the number of bytes in the \214le)-.12 F 7.936(.T)-.216 G
1.264(he contents of)-7.936 F 1.013
(the \214le immediately follow the header)102 430 R 7.685(.T)-1.2 G
1.013(he bytes of the pa)-7.685 F 1.013(yload are unstruc-)-.12 F
(tured and ma)102 444 Q 3.336(yc)-.12 G(ontain null bytes)-3.336 E 6.672
(.B)-.3 G(inary \214les are acceptable)-6.672 E(.)-.216 E F2
(cix_command::RM)72 464 Q F1(\(C)6 E F3<ae>A F1(S\))A
(Request to remove a \214le)102 478 Q 6.672(.T)-.216 G(he pa)-6.672 E
(yload length is 0.)-.12 E F2(cix_command::FILE)72 498 Q F1(\(S)6 E F3
<ae>A F1(C\))A 1.476(Response to a)102 512 R F2(cix_command::GET)4.812 E
F1 8.148(.T)C 1.476(he \214lename is the same as in the request)-8.148 F
1.45(and the pa)102 526 R 1.449
(yload length re\215ects the number of bytes in the \214le)-.12 F 8.121
(.T)-.216 G 1.449(he pa)-8.121 F(yload)-.12 E
(consists of the bytes of the \214le)102 540 Q(.)-.216 E F2
(cix_command::LSOUT)72 560 Q F1(\(S)6 E F3<ae>A F1(C\))A .289
(Response to a)102 574 R F2(cix_command::LS)3.625 E F1 6.961(.T)C .289
(he \214lename is zeroed and the pa)-6.961 F .29(yload length)-.12 F
1.241(is the number of bytes sent in the pa)102 588 R 4.577(yload. The)
-.12 F(pa)4.577 E 1.24(yload is the output of the)-.12 F(command)102 602
Q F2(ls -l)3.336 E F1(.)A F2(cix_command::ACK)72 622 Q F1(\(S)6 E F3<ae>
A F1(C\))A .085(Response to either a)102 636 R F2(cix_command::PUT)3.421
E F1 .085(or a)3.421 F F2(cix_command::RM)3.421 E F1 .086
(indicating that the)3.421 F(request w)102 650 Q
(as successfully completed.)-.216 E F2(cix_command::NAK)72 670 Q F1(\(S)
6 E F3<ae>A F1(C\))A .676(Response to any request that fails)102 684 R
7.348(.T)-.3 G .676(here is no pa)-7.348 F 4.011(yload. The)-.12 F .675
(\214lename \214eld is)4.011 F .042(the same as w)102 698 R .043
(as in the original request.)-.216 F .043(The pa)6.715 F .043
(yload \214eld is set to the value of)-.12 F F2(errno)102 712 Q F1
(in the server')3.336 E 3.336(sa)-.3 G(ttempt to preform a task.)-3.336
E 0 Cg EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CMPS-109 \203 W)72 50 Q
(inter 2016 \203 Program 5 \203 Client/Server and Sockets)-.216 E/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(4o)32.16 G 3.336(f5)-3.336 G F0 3.444
(5. Procedures)72 74 R F1(Eac)72 94 Q 3.703(ho)-.084 G 3.703(ft)-3.703 G
.367(he above commands requires procedures for accessing \214les)-3.703
F 3.702(,i)-.3 G(nc)-3.702 E .366(luding read-)-.084 F .954(ing \214les\
 from disk and writing \214les to disk, as well as accessing directorie\
s)72 108 R 7.626(.W)-.3 G(hen)-7.626 E 1.678
(any of the system calls fails in the server)72 122 R 5.014(,t)-1.2 G
1.678(he server immediately terminates the)-5.014 F .214
(operation and sends the value of)72 136 R/F2 12/Courier-Elite-Bold@0 SF
(errno)3.55 E F1(bac)3.55 E 3.55(kt)-.084 G 3.55(ot)-3.55 G .214(he c)
-3.55 F .215(lient in a)-.084 F F2(cix_command::NAK)3.551 E F1(mes-)
3.551 E(sage)72 150 Q(.)-.216 E 2.664(\(a\) F)81.336 170 R .296
(or the c)-.66 F .295
(lient or server to send a \214le it must \214rst be read into a buffer)
-.084 F 6.967(.B)-1.2 G(inary)-6.967 E 2.974
(\214les must be properly handled, so protocols whic)102 184 R 6.31(ha)
-.084 G 2.974(ssume text \214les won't)-6.31 F 4.168(work. T)102 198 R
4.168(ol)-.66 G .831(oad a \214le from disk, use)-4.168 F F2
(istream::read\(\))4.167 E F1 4.167(,c)C .831(ollecting c)-4.167 F .831
(haracters into)-.084 F 4.197(ab)102 212 S(uffer)-4.197 E 7.533(.R)-1.2
G .862(ead the entire \214le into a buffer then c)-7.533 F .862
(lose it.)-.084 F .862(After that, it ma)7.534 F 4.198(yb)-.12 G(e)
-4.198 E .638(sent down the soc)102 226 R 3.974(ket. Alternatively)-.084
F(,)-1.5 E F2(stat)3.974 E F1 .638
(\(2\) the \214le to see how large it is)B 3.973(,a)-.3 G(nd)-3.973 E
(send the \214le down the soc)102 240 Q(ket piecemeal.)-.084 E 2.664
(\(b\) When)81.336 260 R 1.284(receiving a \214le from the soc)4.62 F
1.284(ket, Receive the header and determine the)-.084 F .458
(size of the \214le)102 274 R 7.13(.C)-.216 G .458(reate an)-7.13 F F2
(ostream)3.794 E F1 .458(and use)3.794 F F2(ostream::write\(\))3.794 E
F1 .457(to write the parts)3.794 F .906
(of the \214le as they are received from the soc)102 288 R 4.243(ket. A)
-.084 F .907(C++ stream is c)4.243 F .907(losed when)-.084 F
(the variable goes out of scope)102 302 Q 3.336(,o)-.216 G 3.336(ry)
-3.336 G(ou can call)-3.336 E F2(close)3.336 E F1(.)A 2.664(\(c\) T)
82.68 322 R 3.336(od)-.66 G(elete a \214le for the)-3.336 E F2
(cix_command::RM)3.336 E F1(command, use)3.336 E F2(unlink)3.336 E F1
-1.336(\(2\) :)B F2(rc = unlink \(filename\);)115.5 336 Q F1 2.664
(\(d\) T)81.12 356 R 4.156(oe)-.66 G .82(xecute the)-4.156 F F2
(cix_command::LS)4.156 E F1 .82(command use)4.156 F F2(popen)4.156 E F1
.819(\(2\) and)B F2(pclose)4.155 E F1 .819(\(2\) to create)B 3.336(ap)
102 370 S(ipe stream from the)-3.336 E F2(ls)3.336 E F1(\(1\) command)A
F2(FILE* pipe = popen \("ls -l", "r"\);)115.5 384 Q F1 1.083
(Then read the c)102 398 R 1.084
(haracters from the pipe in the easiest w)-.084 F -.12(ay)-.216 G 4.42
(,p)-1.38 G 1.084(robably by using)-4.42 F F2(fgets)102 412 Q F1 3.405
(\(3\). F)B(inally)-.12 E(,)-1.5 E F2(pclose\(pipe\))3.405 E F1 6.741
(.T)C .069(hen send the output bac)-6.741 F 3.405(kt)-.084 G .069(he c)
-3.405 F .069(lient in a)-.084 F F2(cix_)3.405 E(command::LSOUT)102 426
Q F1(message)3.336 E(.)-.216 E F0 3.444(6. Modules)72 452 R F1 1.46
(There will need to be several modules in this suite of programs)72 472
R 8.132(.E)-.3 G(ac)-8.132 E 4.796(ho)-.084 G 4.796(ft)-4.796 G 1.46
(he pro-)-4.796 F(grams)72 486 Q 3.336(,o)-.3 G 3.336(fc)-3.336 G(ourse)
-3.336 E 3.336(,w)-.216 G(ill ha)-3.336 E
(ve its own source \214le with a main function in it.)-.12 E(The)72 506
Q F2(sockets)3.336 E F1(module will be a useful inc)3.336 E
(lusion into the program as its own module)-.084 E(.)-.216 E .366
(There should also be a)72 526 R F2(cix_protocol)3.702 E F1 .366
(module to implement the protocols and contain)3.702 F 1.035
(code for accessing \214les and soc)72 540 R(kets)-.084 E 4.371(,s)-.3 G
1.035(ince these will be used by both the c)-4.371 F 1.036(lient and)
-.084 F(the server)72 554 Q(.)-1.2 E F0 3.444(7. Use)72 580 R(of ports)
3.444 E F1 1.142(If your daemon listens on a port that has been bound b\
y another process)72 600 R 4.478(,y)-.3 G 1.142(ou will)-4.478 F .022
(get the message `)72 614 R -.888(`A)-.3 G .022(ddress already in use')
.888 F 3.358('b)-.3 G .023(ecause only one process at any given time)
-3.358 F .479(is allowed to listen on a particular process)72 628 R 7.15
(.T)-.3 G 3.814(oa)-7.81 G .478(void this)-3.934 F 3.814(,c)-.3 G .478
(hoose a port number not)-3.898 F
(being used by anyone else on the same server)72 642 Q(.)-1.2 E 2.212
-.66(To a)72 662 T .892(void ha).54 F .892
(ving to type in a port number every time you start your server)-.12 F
4.229(,p)-1.2 G .893(ut the)-4.229 F(following line in your)72 676 Q F2
(.bashrc)3.336 E F1(or)3.336 E F2(.bash_profile)3.336 E F1 -1.336
(\214le :)3.336 F F2(export CIX_CLIENT_PORT 60000)85.5 690 Q F1 1.14
(except that eac)72 704 R 4.475(hp)-.084 G 1.139(erson in c)-4.475 F
1.139(lass should use a different number)-.084 F 7.811(.Y)-1.2 G 1.139
(ou should pic)-9.011 F 4.475(ka)-.084 G 3.105(dynamic or private port \
number from the range 49152 through 65535 \(0xC000)72 718 R
(through 0xFFFF\).)72 732 Q 0 Cg EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CMPS-109 \203 W)72 50 Q
(inter 2016 \203 Program 5 \203 Client/Server and Sockets)-.216 E/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(5o)32.16 G 3.336(f5)-3.336 G F0 3.444
(8. Runaway)72 74 R(Processes)3.444 E F1 1.364(Be careful in using)72 94
R/F2 12/Courier-Elite-Bold@0 SF(fork)4.7 E F1 1.363
(\(2\) so that you don't accidentally create a fork-bomb)B 8.035(.T)
-.216 G(he)-8.035 E(command)72 108 Q F2(pkill)4.746 E F1 1.41
(\(1\) can be used to kill all processes matc)B 1.41
(hing a particular pattern.)-.084 F(So the command)72 122 Q F2
(pkill cix)85.5 136 Q F1 1.425
(will kill all of your processes whose executables contain the string `)
72 150 R(`)-.3 E F2(cix)A F1 -.3('')C 8.097(.A).3 G(really)-3.336 E
(quic)72 164 Q 3.336(kw)-.084 G .24 -.12(ay t)-3.552 H 3.336(ol).12 G
(og out is to use)-3.336 E F2(kill)3.336 E F1 -1.336(\(1\) :)B F2
(kill -9 -1)85.5 178 Q(kill -s KILL -1)85.5 192 Q F1(will send)72 206 Q
F2(SIGKILL)3.336 E F1(to all of your processes)3.336 E 3.336(,t)-.3 G
(hus logging you out.)-3.336 E F0 3.444(9. What)72 232 R(to Submit)3.444
E F1(Submit)72 252 Q F2(Makefile)4.165 E F1(whic)4.165 E 4.165(hb)-.084
G .829(uilds both programs)-4.165 F 4.165(,a)-.3 G .829
(ll necessary C++ header and imple-)-4.165 F .732(mentation \214les)72
266 R 7.404(.A)-.3 G .732(nd if doing pair programming)-7.404 F 4.068
(,t)-.3 G(he)-4.068 E F2(PARTNER)4.068 E F1(\214le)4.068 E 7.404(.W)
-.216 G .732(hen the grader)-7.404 F(uses the command)72 280 Q F2(make)
3.336 E F1(in the submit directory)3.336 E 3.336(,t)-1.5 G
(he three binaries should be built.)-3.336 E 0 Cg EP
%%Trailer
end
%%EOF
